<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Annual Mass Shooting Data</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
	--bg: #0f172a;
	--bg-secondary: #0b1224;
	--card: rgba(255, 255, 255, 0.08);
	--border: rgba(255, 255, 255, 0.16);
	--text: #e7eefc;
	--muted: #b8c2d8;
	--accent: #ff914d;
	--shadow: 0 20px 60px rgba(0, 0, 0, 0.45);
	--max-width: 960px;
}

* { box-sizing: border-box; }

body {
	margin: 0;
	min-height: 100vh;
	font-family: 'Manrope', system-ui, -apple-system, sans-serif;
	color: var(--text);
	background: radial-gradient(circle at 20% 20%, #1e293b 0, transparent 35%),
		radial-gradient(circle at 80% 0%, #132c4a 0, transparent 30%),
		linear-gradient(135deg, var(--bg-secondary), var(--bg));
	display: flex;
	align-items: center;
	justify-content: center;
	padding: 48px 24px;
}

.page-shell {
	width: min(100%, var(--max-width));
	display: grid;
	gap: 20px;
}

.hero { text-align: center; }

.eyebrow {
	letter-spacing: 0.08em;
	text-transform: uppercase;
	font-weight: 700;
	color: var(--accent);
	margin: 0 0 8px;
}

h1 {
	margin: 0;
	font-size: clamp(32px, 4vw, 46px);
	line-height: 1.1;
}

.lede {
	margin: 10px auto 0;
	max-width: 46ch;
	color: var(--muted);
}

.stats-card {
	background: var(--card);
	border: 1px solid var(--border);
	border-radius: 20px;
	backdrop-filter: blur(10px);
	padding: 28px;
	display: grid;
	grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
	gap: 18px;
	box-shadow: var(--shadow);
}

.stat {
	padding: 14px 12px;
	border-radius: 14px;
	background: rgba(255, 255, 255, 0.02);
	border: 1px solid rgba(255, 255, 255, 0.08);
}

.label {
	margin: 0 0 6px;
	color: var(--muted);
	font-weight: 600;
	letter-spacing: 0.01em;
}

.value {
	margin: 0;
	font-size: clamp(32px, 5vw, 56px);
	font-weight: 700;
	color: var(--accent);
	line-height: 1;
}

.meta {
	grid-column: 1 / -1;
	margin: 6px 0 0;
	color: var(--muted);
	text-align: right;
}

.footnotes {
	text-align: center;
	color: var(--muted);
	font-size: 0.95rem;
	line-height: 1.5;
}

.footnotes a {
	color: var(--text);
	font-weight: 600;
	text-decoration: none;
	border-bottom: 1px solid rgba(255, 255, 255, 0.25);
}

.footnotes a:hover {
	color: var(--accent);
	border-bottom-color: var(--accent);
}

.credit { margin: 6px 0 0; }

@media (max-width: 640px) {
	body { padding: 32px 18px; }
	.stats-card { padding: 22px; }
	.meta { text-align: left; }
}
  </style>
</head>

<body>
  <div class="page-shell">
    <header class="hero">
      <p class="eyebrow">Real-time snapshot</p>
      <h1>U.S. mass shootings in <span id="current-year">—</span></h1>
      <p class="lede">Live totals compiled from massshootingtracker.site and refreshed when you load this page.</p>
    </header>

    <main class="stats-card" aria-live="polite">
      <div class="stat">
        <p class="label">Total incidents this year</p>
        <p id="how-many-shootings" class="value">Loading…</p>
      </div>
      <div class="stat">
        <p class="label">Day of the year</p>
        <p id="DOY" class="value">—</p>
      </div>
      <div class="stat">
        <p class="label">Average per day</p>
        <p id="average-shootings-per-day" class="value">—</p>
      </div>
      <p id="meta" class="meta">Calculating…</p>
    </main>

    <footer class="footnotes">
      <p>Data source: <a href="https://massshootingtracker.site/" target="_blank" rel="noopener">massshootingtracker.site</a></p>
      <p class="credit">Built to surface the scale of gun violence in near real time.</p>
      <noscript>Please enable JavaScript to load the latest counts.</noscript>
    </footer>
  </div>

  <script type="module">
    const currentYearEl = document.getElementById('current-year');
    const totalEl = document.getElementById('how-many-shootings');
    const doyEl = document.getElementById('DOY');
    const avgEl = document.getElementById('average-shootings-per-day');
    const metaEl = document.getElementById('meta');

    const today = new Date();
    const year = today.getFullYear();
    currentYearEl.textContent = year;

    const dayOfYear = (() => {
      const start = new Date(year, 0, 0);
      const diff = today - start;
      return Math.floor(diff / 86400000);
    })();
    doyEl.textContent = dayOfYear.toString();

    const numberFormatter = new Intl.NumberFormat('en-US');
    const metaTimeFormatter = new Intl.DateTimeFormat('en-US', {
      dateStyle: 'medium',
      timeStyle: 'short'
    });

    async function fetchShootings() {
      const url = `https://mass-shooting-tracker-data.s3.us-east-2.amazonaws.com/${year}-data.json`;
      try {
        const response = await fetch(url, { cache: 'no-store' });
        if (!response.ok) throw new Error(`HTTP ${response.status}`);
        const shootings = await response.json();
        return shootings.length;
      } catch (err) {
        console.error('Failed to load shooting data', err);
        throw err;
      }
    }

    (async () => {
      try {
        const count = await fetchShootings();
        totalEl.textContent = numberFormatter.format(count);
        const avg = count / dayOfYear;
        avgEl.textContent = isFinite(avg) ? avg.toPrecision(3) : '—';
        metaEl.textContent = `Updated ${metaTimeFormatter.format(new Date())}`;
      } catch (error) {
        totalEl.textContent = 'Unavailable';
        avgEl.textContent = 'Unavailable';
        metaEl.textContent = 'Could not load data. Please refresh to try again.';
      }
    })();
  </script>
  <!-- Credit for the shooting data goes to massshootingtracker.site -->
</body>

</html>
